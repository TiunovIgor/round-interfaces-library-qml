<a href="../../readme.ru.html">Главная</a> → Сегмент  

***

# Segment

## Содержание
1. [Описание объекта](#description)  
2. [Зависимости объекта](#dependencies)  
3. [Создание объекта](#constructor)  
4. [Примеры] (#examples)  
5. [Свойства](#properties)  
6. [Методы](#methods)  
7. [События](#events)  

##<a id="description"></a>Описание объекта

Сегмент кольца – это часть круга, ограниченная двумя окружностями разных радиусов с общим центром и двумя лучами, исходящими из этого центра (рис. 1).

![SegmentGeometry](../../docs/images/segment_geometry.png)  
Рис. 1 - Геометрия сегмента кольца

C - центр сегмента - это центр ограничивающих окружностей и начало ограничивающих лучей.  
R1 - радиус меньшей окружности.  
R2 - радиус большей окружности.  
CA - луч, ограничивающий сегмент и определяющий его начало.  
CB - луч, ограничивающий сегмент и определяющий его конец.  
T - толщина сегмента, равная разнице между R2 и R1.  
α - начальный угол сегмента - это угол между горизонтальной осью X и лучом CA.  
β - угол сегмент - это угол между лучами CA и CB.  

##<a id="dependencies"></a>Зависимости объекта  
Для создания объекта типа Segment необходимо подключить следующие скрипты:  

* segment-gradient.js  
* utilities.js  

##<a id="constructor"></a>Создание объекта  
Для создания объекта в функцию-конструктор передаются основные параметры:   
>
*id* - идентификатор сегмента в виде текстовой строки.  
*context* - контекст типа CanvasRenderingContext2D для отрисовки сегмента.  
*cx* - координата X центра сегмента.  
*cy* - координата Y центра сегмента.  
*r_in* - внутренний радиус сегмента.  
*thickness* - толщина сегмента.  
*init_angle* - начальный угол сегмента в градусах. Может принимать отрицательные значения. 
*angle* - угол сегмента в градусах.

Внешний радиус сегмента *r_out* будет рассчитан автоматически в процессе создания объекта.

Объект примет форму кольца, если угол сегмента *angle* задать кратным 360 градусам.  
Объект примет форму сегмента круга, если внутренний радиус *r_in* задать равным 0.  
Объект примет форму круга, если выполнить оба этих условия.

##<a id="examples"></a>Примеры  
<a href="../../examples/segment-examples.html" target="_blank">Примеры</a> использования различных свойств и методов объекта.  

##<a id="properties"></a>Свойства

### Стиль оформления сегмента  
>
*gradient* - градиент заливки типа <a href="segment-gradient.ru.html">SegmentGradient</a>.
  
>Допустимые значения направления для линейного градиента:  
>> _"from-center"_ - из центра.  
>> _"to-center"_ - к центру.  
>> _"from-opening"_ - от открывающей границы к закрыващей вдоль хорды окружности.  
>> _"from-closing"_ - от закрывающей границы к открывающей вдоль хорды окружности.  

>Допустимые значения направления для радиального градиента:  
>> _"from-center"_ - из центра.  
>> _"to-center"_ - к центру.  

>Допустимые значения направления для конического градиента:  
>> _"clockwise"_ - из центра.  
>> _"anticlockwise"_ - к центру.  

>
*background* - цвет заливки (применяется, если не задан градиент заливки).  
*border_width* - толщина границ сегмента.  
*border_color* - цвет границ сегмента.

Границы сегмента могут быть заданы отдельно.  

Типы границ сегмента (рис. 2):

A) Открывающая граница (Opening Border) – сторона сегмента, встречающаяся первой при движении по часовой стрелке.  
> *border_opening_width* - ширина открывающей границы.    
> *border_opening_color* - цвет открывающей границы.  

B) Внешняя граница (Outer Border) – дуга сегмента с большим радиусом.  
> *border_outer_width* - ширина внешней границы.    
> *border_outer_color* - цвет внешней границы.  

C) Внутренняя граница (Inner Border) – дуга сегмента с меньшим радиусом.  
> *border_inner_width* - ширина внутренней границы.    
> *border_inner_color* - цвет внутренней границы.  

D) Закрывающая граница (Closing Border) – сторона сегмента, встречающая последней при движении по часовой стрелке.  
> *border_closing_width* - ширина закрывающей границы.    
> *border_closing_color* - цвет закрывающей границы.  

![SegmentBorders](../../docs/images/segment_borders.png)  
Рис. 2 - Границы сегмента кольца  

Если задана отдельная граница сегмента, то для ее отрисовки будет применяться указанный стиль: ширина и/или цвет.  
Если отдельная граница не задана, то для ее отрисовки будет применяться общий стиль границ сегмента.  

### Флаги сегмента
>
*visible* - видимость. Значение *true* обеспечивает видимость объекта.  
*in_progress* - в процессе. Флаг принимает значение *true* в процессе анимации.  

##<a id="methods"></a>Методы

> *calc()* - выполняет основные вычисления формы и внешнего вида сегмента при его создании, изменении параметров и в процессе анимации.  
Этот метод необходимо вызывать после изменения свойств объекта, чтобы они вступили в силу.  

> *calcBorder()* - определяет стили границ сегмента. Вызывается автоматически из метода *calc()*.  

> *draw()* - функция отрисовки сегмента.  

> *instanceCopy()* - создание независимой копии объекта.  

> *isPointInside(x, y)* - функция проверки принадлежности фигуре точки с координатами (x,y).  

### Анимация сегмента

Анимация сегмента - это различные изменения формы, положения или стиля оформления сегмента со временем.

Основные параметры анимации:
> *duration* - длительность анимации. Задается в секундах.  
> *delay* - задержка перед началом анимации. Задается в секундах.   
> *direction* - направление анимации. Набор допустимых значений зависит от вида анимации.  

#### Методы анимации

> *appear(direction, duration, delay)* - появление сегмента за счет постепенного изменения формы.  

> Допустимые значения параметра *direction* для метода анимации появления:  
>> _"from-center"_ - из центра.  
>> _"to-center"_ - к центру.  
>> _"from-axis"_ - от оси.  
>> _"clockwise"_ - по часовой стрелке.  
>> _"anticlockwise"_ - против часовой стрелки.  

> *disappear(direction, duration, delay)* - исчезание сегмента за счет постепенного изменения формы.  

> Допустимые значения параметра *direction* для метода анимации исчезания:  
>> _"from-center"_ - из центра.  
>> _"to-center"_ - к центру.  
>> _"to-axis"_ - к оси.  
>> _"clockwise"_ - по часовой стрелке.  
>> _"anticlockwise"_ - против часовой стрелки.  

> *rotate(direction, angle, duration, delay)* - поворот сегмента на угол *angle* в течение *duration* секунд.  

> Угол поворота *angle* задается в градусах.  

> Допустимые значения параметра *direction* для метода анимации вращения:  
>> _"clockwise"_ - по часовой стрелке.  
>> _"anticlockwise"_ - против часовой стрелки.  

> *fadeIn(duration, delay)* - постепенное появление сегмента за счет изменения прозрачности.  

> *fadeOut(duration, delay)* - постепенное исчезание сегмента за счет изменения прозрачности.  

##<a id="events"></a> События

События, запускаемые объектом Segment, реализованы с помощью CustomEvent.  
В поле *detail.segment* передается ссылка на сам объект.  

> *segment-changed* - сегмент изменен. Событие запускается каждый раз, когда выполняется метод calc().  

> *segment-appeared* - сегмент появился.  
> *segment-disappeared* - сегмент исчез.  
> *segment-rotated* - сегмент повернут.  
> *segment-faded-in* - сегмент появился методом выцветания.  
> *segment-faded-out* - сегмент исчез методом выцветания.  

***

<a href="../../readme.ru.html">Главная</a> → Сегмент  